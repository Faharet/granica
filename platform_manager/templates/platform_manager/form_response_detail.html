{% extends 'platform_manager/base_with_navbar.html' %}
{% load i18n %}
{% load custom_filters %}

{% block extrahead %}
<style>
  .country-flag {
    display: inline-block;
    width: 24px;
    height: 16px;
    background-size: cover;
    background-position: center;
    border-radius: 2px;
    margin-right: 6px;
    vertical-align: middle;
  }
</style>
{% endblock %}

{% block content %}
  <div class="p-6">
    {% if response %}
      <header class="flex items-start justify-between mb-6">
        <div>
          <h1 class="text-2xl font-bold">{% trans 'Response Details' %}</h1>
        </div>
        <div class="flex items-center space-x-3">
          <a href="{% url 'platform_manager:form_responses' %}" class="btn btn-ghost btn-sm"><i class="fa fa-arrow-left mr-2"></i>{% trans 'Back to list' %}</a>
          {% if is_manager %}
          <a href="{% url 'platform_manager:export_response_pdf' response.id %}" class="btn btn-primary btn-sm"><i class="fa fa-file-pdf mr-2"></i>{% trans 'Export PDF' %}</a>
          {% endif %}
          {% if can_edit %}
          <a href="{% url 'platform_manager:form_response_edit' response.id %}" class="btn btn-warning btn-sm"><i class="fa fa-edit mr-2"></i>{% trans 'Edit' %}</a>
          {% endif %}
          {% if can_delete %}
          <a href="{% url 'platform_manager:form_response_delete' response.id %}" id="delete-link" class="btn btn-error btn-sm"><i class="fa fa-trash mr-2"></i>{% trans 'Delete' %}</a>
          {% endif %}
        </div>
      </header>

      <main class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <section class="bg-base-200 p-6 rounded-lg shadow-sm">
          <h2 class="text-lg font-semibold mb-4">{% trans 'Biographical Data' %}</h2>
          <dl class="space-y-3 text-sm">
            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '1. Full name, date and place of birth' %}</dt>
              <dd class="flex-1 text-gray-800">
                {% if response.last_name or response.first_name or response.patronymic or response.birth_date or response.birth_place %}
                  <div class="space-y-1">
                    {% if response.last_name or response.first_name or response.patronymic %}
                      <div>
                        <strong>{% trans 'Full name:' %}</strong>
                        {{ response.last_name }} {{ response.first_name }} {{ response.patronymic }}
                      </div>
                    {% endif %}
                    {% if response.birth_date %}
                      <div>
                        <strong>{% trans 'Date of birth:' %}</strong>
                        {{ response.birth_date }}
                      </div>
                    {% endif %}
                    {% if response.birth_place %}
                      <div>
                        <strong>{% trans 'Place of birth:' %}</strong>
                        {% if '|' in response.birth_place %}
                          <span class="country-flag" style="background-image: url('https://flagcdn.com/w40/{{ response.birth_place|get_country_code }}.png');"></span>
                          {{ response.birth_place|get_country_name }}
                        {% else %}
                          {{ response.birth_place }}
                        {% endif %}
                      </div>
                    {% endif %}
                  </div>
                {% elif response.full_name_and_birth %}
                  {{ response.full_name_and_birth|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
                {% if response.full_name_photo %}
                  <div class="mt-2">
                    <a href="{{ response.full_name_photo.url }}" target="_blank" class="text-primary hover:underline text-xs">
                      <i class="fa fa-paperclip mr-1"></i>{% trans 'Document Photo' %}
                    </a>
                  </div>
                {% endif %}
                {% if response.person_photo %}
                  <div class="mt-2">
                    <a href="{{ response.person_photo.url }}" target="_blank" class="text-primary hover:underline text-xs">
                      <i class="fa fa-user mr-1"></i>{% trans 'Person Photo' %}
                    </a>
                  </div>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '2. Changed last name/first name/patronymic' %}</dt>
              <dd class="flex-1">
                {% if response.name_changed %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Reason for change' %}</dt>
              <dd class="flex-1 text-gray-800">
                {% if response.name_change_reason %}
                  {{ response.name_change_reason|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '3. Phones and email' %}</dt>
              <dd class="flex-1 text-gray-800">
                {% if response.phones_emails %}
                  {{ response.phones_emails|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '4. Military service' %}</dt>
              <dd class="flex-1">
                {% if response.military_service %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Service details' %}</dt>
              <dd class="flex-1 text-gray-800">
                {% if response.military_details %}
                  {{ response.military_details|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>
          </dl>
        </section>

        <section class="bg-base-200 p-6 rounded-lg shadow-sm">
          <h2 class="text-lg font-semibold mb-4">{% trans 'Criminal and Legal Information' %}</h2>
          <dl class="space-y-3 text-sm">
            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '5. Criminal record' %}</dt>
              <dd class="flex-1">
                {% if response.criminal_record %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Period and place of serving sentence' %}</dt>
              <dd class="flex-1">
                {% if response.criminal_period_where %}
                  {{ response.criminal_period_where|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'For what crimes' %}</dt>
              <dd class="flex-1">
                {% if response.criminal_offenses %}
                  {{ response.criminal_offenses|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '6. Detained abroad' %}</dt>
              <dd class="flex-1">
                {% if response.detained_abroad %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'When and why detained' %}</dt>
              <dd class="flex-1">
                {% if response.detained_when_why %}
                  {{ response.detained_when_why|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Where held' %}</dt>
              <dd class="flex-1">
                {% if response.detained_where %}
                  {{ response.detained_where|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>
          </dl>
        </section>

        <section class="bg-base-200 p-6 rounded-lg shadow-sm">
          <h2 class="text-lg font-semibold mb-4">{% trans 'Relatives and Religion' %}</h2>
          <dl class="space-y-3 text-sm">
            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '7. Relatives in specified countries' %}</dt>
              <dd class="flex-1">
                {% if response.relatives_in_countries %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Details about relatives' %}</dt>
              <dd class="flex-1">
                {% if response.relatives_details %}
                  {{ response.relatives_details|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '8. Religious' %}</dt>
              <dd class="flex-1">
                {% if response.religious %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Religious views/madhhab' %}</dt>
              <dd class="flex-1">
                {% if response.denomination %}
                  {{ response.get_denomination_display }}
                  {% if response.denomination == 'other' and response.denomination_other %}
                    : {{ response.denomination_other }}
                  {% endif %}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '9. Are relatives wanted' %}</dt>
              <dd class="flex-1">
                {% if response.relatives_wanted %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Reason for search' %}</dt>
              <dd class="flex-1">
                {% if response.relatives_wanted_reason %}
                  {{ response.relatives_wanted_reason|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>
          </dl>
        </section>

        <section class="bg-base-200 p-6 rounded-lg shadow-sm">
          <h2 class="text-lg font-semibold mb-4">{% trans 'Trips and Deportations' %}</h2>
          <dl class="space-y-3 text-sm">
            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '10. Visited specified countries' %}</dt>
              <dd class="flex-1">
                {% if response.visited_countries %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Details of visits' %}</dt>
              <dd class="flex-1">
                {% if response.visited_countries_details %}
                  {{ response.visited_countries_details|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '11. Deportation/expulsion' %}</dt>
              <dd class="flex-1">
                {% if response.deported %}
                  <span class="badge badge-success badge-sm">{% trans 'Yes' %}</span>
                {% else %}
                  <span class="badge badge-outline badge-sm">{% trans 'No' %}</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans 'Deportation details' %}</dt>
              <dd class="flex-1">
                {% if response.deportation_details %}
                  {{ response.deportation_details|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '12. Reason for not being allowed entry' %}</dt>
              <dd class="flex-1">
                {% if response.not_allowed_reason %}
                  {{ response.not_allowed_reason|linebreaksbr }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>

            <div class="flex items-start gap-4">
              <dt class="w-44 text-gray-600">{% trans '13. When was the last time you were in your homeland' %}</dt>
              <dd class="flex-1">
                {% if response.last_time_in_homeland %}
                  {{ response.last_time_in_homeland }}
                {% else %}
                  <span class="text-gray-400">—</span>
                {% endif %}
              </dd>
            </div>
          </dl>
        </section>

        <!-- Border Officer Assessment Section -->
        {% if response.officer_assessment %}
          <section class="bg-base-200 p-6 rounded-lg shadow-sm md:col-span-2">
            <h2 class="text-lg font-semibold mb-4">{% trans 'Border Officer Assessment' %}</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- Question 14: Radical Internet (65 points) -->
              <div class="border-l-4 {% if response.officer_assessment.radical_internet %}
                  border-error
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '14. Member of radical internet communities' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.radical_internet %}
                        badge-error
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.radical_internet %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.radical_internet %}
                        +65
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.radical_internet_content or response.officer_assessment.radical_internet_sheikhs %}
                  <dd class="text-sm mt-2 space-y-2">
                    {% if response.officer_assessment.radical_internet_content %}
                      <div>
                        <strong class="text-gray-700">{% trans 'Content type:' %}</strong>
                        <ul class="list-disc list-inside ml-2 text-gray-600">
                          {% for item in response.officer_assessment.get_radical_internet_content_labels %}
                            <li>{{ item }}</li>
                          {% endfor %}
                        </ul>
                      </div>
                    {% endif %}
                    {% if response.officer_assessment.radical_internet_sheikhs %}
                      <div>
                        <strong class="text-gray-700">{% trans 'Sheikh names:' %}</strong>
                        <ul class="list-disc list-inside ml-2 text-gray-600">
                          {% for item in response.officer_assessment.get_radical_internet_sheikhs_labels %}
                            <li>{{ item }}</li>
                          {% endfor %}
                        </ul>
                      </div>
                    {% endif %}
                  </dd>
                {% endif %}
                {% if response.officer_assessment.radical_internet_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.radical_internet_details|linebreaksbr }}</dd>
                {% endif %}
                {% if response.officer_assessment.radical_internet_photo %}
                  <dd class="mt-2">
                    <a href="{{ response.officer_assessment.radical_internet_photo.url }}" target="_blank" class="text-primary hover:underline text-xs">
                      <i class="fa fa-paperclip mr-1"></i>{% trans 'Attached photo' %}
                    </a>
                  </dd>
                {% endif %}
              </div>

              <!-- Question 15: Radical Religious Ideology (45 points) -->
              <div class="border-l-4 {% if response.officer_assessment.radical_religious_ideology %}
                  border-error
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '15. Supporter of radical religious movements' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.radical_religious_ideology %}
                        badge-error
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.radical_religious_ideology %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.radical_religious_ideology %}
                        +45
                      {% else %}
                        0
                      {% endif %}баллов
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.radical_religious_signs %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Signs:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_radical_religious_signs_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.radical_religious_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.radical_religious_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 16: Document Issues (20 points) -->
              <div class="border-l-4 {% if response.officer_assessment.document_issues %}
                  border-warning
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '16. Document issues' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.document_issues %}
                        badge-warning
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.document_issues %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.document_issues %}
                        +20
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.document_issues_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Problems:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_document_issues_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.document_issues_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.document_issues_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 17: Religious Deviations (15 points) -->
              <div class="border-l-4 {% if response.officer_assessment.religious_deviations %}
                  border-warning
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '17. Religious deviations' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.religious_deviations %}
                        badge-warning
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.religious_deviations %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.religious_deviations %}
                        +15
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.religious_deviations_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Deviations:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_religious_deviations_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.religious_deviations_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.religious_deviations_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 18: Suspicious Mobile Content (15 points) -->
              <div class="border-l-4 {% if response.officer_assessment.suspicious_mobile_content %}
                  border-warning
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '18. Suspicious content on mobile devices' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.suspicious_mobile_content %}
                        badge-warning
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.suspicious_mobile_content %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.suspicious_mobile_content %}
                        +15
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.suspicious_mobile_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Types:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_suspicious_mobile_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.suspicious_mobile_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.suspicious_mobile_details|linebreaksbr }}</dd>
                {% endif %}
                {% if response.officer_assessment.suspicious_mobile_photo %}
                  <dd class="text-sm text-gray-600 mt-2">
                    <strong>Фото:</strong> <a href="{{ response.officer_assessment.suspicious_mobile_photo.url }}" target="_blank" class="link link-primary">Прикрепленное фото</a>
                  </dd>
                {% endif %}
              </div>

              <!-- Question 19: Suspicious Behavior (15 points) -->
              <div class="border-l-4 {% if response.officer_assessment.suspicious_behavior %}
                  border-warning
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '19. Suspicious behavior' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.suspicious_behavior %}
                        badge-warning
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.suspicious_behavior %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.suspicious_behavior %}
                        +15
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.suspicious_behavior_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Behavior:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_suspicious_behavior_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.suspicious_behavior_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.suspicious_behavior_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 20: Psychological Issues (15 points) -->
              <div class="border-l-4 {% if response.officer_assessment.psychological_issues %}
                  border-warning
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '20. Psychological deviations' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.psychological_issues %}
                        badge-warning
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.psychological_issues %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.psychological_issues %}
                        +15
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.psychological_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Deviations:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_psychological_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.psychological_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.psychological_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 21: Relatives MTO (10 points) -->
              <div class="border-l-4 {% if response.officer_assessment.relatives_mto %}
                  border-info
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '21. Relatives with close ties to terrorist organizations' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.relatives_mto %}
                        badge-info
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.relatives_mto %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.relatives_mto %}
                        +10
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.relatives_mto_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Connection type:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_relatives_mto_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.relatives_mto_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.relatives_mto_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 22: Criminal Element (10 points) -->
              <div class="border-l-4 {% if response.officer_assessment.criminal_element %}
                  border-info
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '22. Criminally-oriented element' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.criminal_element %}
                        badge-info
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.criminal_element %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.criminal_element %}
                        +10
                      {% else %}
                        0
                      {% endif %} {% trans 'points' %}
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.criminal_element_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Activity type:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_criminal_element_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.criminal_element_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.criminal_element_details|linebreaksbr }}</dd>
                {% endif %}
              </div>

              <!-- Question 23: Violence Traces (10 points) -->
              <div class="border-l-4 {% if response.officer_assessment.violence_traces %}
                  border-info
                {% else %}
                  border-gray-300
                {% endif %} pl-4 py-2">
                <div class="flex items-center justify-between mb-1">
                  <dt class="text-sm font-medium text-gray-700">{% trans '23. Traces of violent actions on the body' %}</dt>
                  <div class="flex items-center gap-2">
                    <span class="badge badge-sm {% if response.officer_assessment.violence_traces %}
                        badge-info
                      {% else %}
                        badge-outline
                      {% endif %}">
                      {% if response.officer_assessment.violence_traces %}
                        {% trans 'Yes' %}
                      {% else %}
                        {% trans 'No' %}
                      {% endif %}
                    </span>
                    <span class="text-xs font-bold text-gray-500">
                      {% if response.officer_assessment.violence_traces %}
                        +10
                      {% else %}
                        0
                      {% endif %}баллов
                    </span>
                  </div>
                </div>
                {% if response.officer_assessment.violence_traces_types %}
                  <dd class="text-sm mt-2">
                    <strong class="text-gray-700">{% trans 'Trace type:' %}</strong>
                    <ul class="list-disc list-inside ml-2 text-gray-600">
                      {% for item in response.officer_assessment.get_violence_traces_types_labels %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  </dd>
                {% endif %}
                {% if response.officer_assessment.violence_traces_details %}
                  <dd class="text-sm text-gray-600 mt-2 bg-white p-2 rounded"><strong>{% trans 'Additional details:' %}</strong> {{ response.officer_assessment.violence_traces_details|linebreaksbr }}</dd>
                {% endif %}
              </div>
            </div>

            <!-- Additional Notes -->
            {% if response.officer_assessment.notes %}
              <div class="mt-4 p-4 bg-white rounded-lg">
                <h3 class="text-sm font-semibold text-gray-700 mb-2">Дополнительные заметки пограничника:</h3>
                <p class="text-sm text-gray-600">{{ response.officer_assessment.notes|linebreaksbr }}</p>
              </div>
            {% endif %}
          </section>
        {% endif %}
      </main>

      <!-- Threat Assessment Card -->
      <section class="mb-6">
        <div class="alert {% if response.threat_level == 'Высокий' %}
            alert-error
          {% elif response.threat_level == 'Средний' %}
            alert-warning
          {% else %}
            alert-success
          {% endif %} shadow-lg">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current flex-shrink-0 w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <div>
              <h3 class="font-bold text-lg">Уровень опасности: {{ response.threat_level }}</h3>
              <div class="text-sm">
                {% trans 'Total score:' %} <span class="font-bold">{{ response.total_score }}</span> {% trans 'out of' %} 220
              </div>
              <div class="text-xs mt-1 opacity-80">
                {% if response.threat_level == 'Низкий' %}
                  {% trans '0-49 points - Low threat level' %}
                {% elif response.threat_level == 'Средний' %}
                  {% trans '50-119 points - Medium threat level' %}
                {% else %}
                  {% trans '120+ points - High threat level' %}
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </section>

      <footer class="mt-6 flex items-center justify-between">
        <div class="text-sm text-gray-500">Создано: {{ response.created_at|date:'d/m/Y H:i' }}</div>
        <div class="text-sm text-gray-500">&nbsp;</div>
      </footer>


    {% else %}
      <p>
        {% trans 'Response not found' %}
      </p>
    {% endif %}
  </div>
{% endblock %}


